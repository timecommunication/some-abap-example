CLASS zcl_matnr_func_cds DEFINITION
  PUBLIC
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
    INTERFACES IF_AMDP_MARKER_HDB.

    CLASS-METHODS:
        MATNR_DESC FOR TABLE FUNCTION ZMATNR_TFUNC .

  PROTECTED SECTION.
  PRIVATE SECTION.
ENDCLASS.



CLASS zcl_matnr_func_cds IMPLEMENTATION.
    METHOD MATNR_DESC
        BY DATABASE FUNCTION
        FOR HDB LANGUAGE SQLSCRIPT
        OPTIONS READ-ONLY
        USING MARA MAKT .

        ITAB_MATNR =
            SELECT DISTINCT MARA.MATNR AS MATNR ,
                            MAKT.MAKTX AS MAKTX ,
                            MARA.MANDT AS MANDT
                   FROM MARA JOIN MAKT
                   ON MARA.MATNR = MAKT.MATNR ;

        RETURN
            SELECT MANDT, MATNR, MAKTX
            FROM :ITAB_MATNR;


   ENDMETHOD.
ENDCLASS.